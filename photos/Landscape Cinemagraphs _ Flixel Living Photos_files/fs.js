try{"undefined"===typeof WeakMap&&function(){var g=Object.defineProperty,y=Date.now()%1E9,a=function(){this.name="__st"+(1E9*Math.random()>>>0)+(y++ +"__")};a.prototype={set:function(a,f){var d=a[this.name];d&&d[0]===a?d[1]=f:g(a,this.name,{value:[a,f],writable:!0})},get:function(a){var f;return(f=a[this.name])&&f[0]===a?f[1]:void 0}};window.WeakMap=a}()}catch(e$$12){};try{(function(g){function y(){r=!1;var b=s;s=[];b.sort(function(a,b){return a.uid_-b.uid_});var k=!1;b.forEach(function(b){var n=b.takeRecords();a(b);n.length&&(b.callback_(n,b),k=!0)});k&&y()}function a(a){a.nodes_.forEach(function(b){(b=n.get(b))&&b.forEach(function(b){b.observer===a&&b.removeTransientObservers()})})}function e(a,b){for(var k=a;k;k=k.parentNode){var c=n.get(k);if(c)for(var p=0;p<c.length;p++){var d=c[p],l=d.options;(k===a||l.subtree)&&(l=b(l))&&d.enqueue(l)}}}function f(a){this.callback_=
a;this.nodes_=[];this.records_=[];this.uid_=++q}function d(a,b){this.type=a;this.target=b;this.addedNodes=[];this.removedNodes=[];this.oldValue=this.attributeNamespace=this.attributeName=this.nextSibling=this.previousSibling=null}function c(a,b){return u=new d(a,b)}function b(a){if(v)return v;var b=u,k=new d(b.type,b.target);k.addedNodes=b.addedNodes.slice();k.removedNodes=b.removedNodes.slice();k.previousSibling=b.previousSibling;k.nextSibling=b.nextSibling;k.attributeName=b.attributeName;k.attributeNamespace=
b.attributeNamespace;k.oldValue=b.oldValue;v=k;v.oldValue=a;return v}function k(a,b,k){this.observer=a;this.target=b;this.options=k;this.transientObservedNodes=[]}var n=new WeakMap,p=window.msSetImmediate;if(!p){var l=[],h=String(Math.random());window.addEventListener("message",function(a){a.data===h&&(a=l,l=[],a.forEach(function(a){a()}))});p=function(a){l.push(a);window.postMessage(h,"*")}}var r=!1,s=[],q=0;f.prototype={observe:function(a,b){a=window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(a)||
a;if(!b.childList&&!b.attributes&&!b.characterData||b.attributeOldValue&&!b.attributes||b.attributeFilter&&b.attributeFilter.length&&!b.attributes||b.characterDataOldValue&&!b.characterData)throw new SyntaxError;var c=n.get(a);c||n.set(a,c=[]);for(var p,d=0;d<c.length;d++)if(c[d].observer===this){p=c[d];p.removeListeners();p.options=b;break}p||(p=new k(this,a,b),c.push(p),this.nodes_.push(a));p.addListeners()},disconnect:function(){this.nodes_.forEach(function(a){a=n.get(a);for(var b=0;b<a.length;b++){var k=
a[b];if(k.observer===this){k.removeListeners();a.splice(b,1);break}}},this);this.records_=[]},takeRecords:function(){var a=this.records_;this.records_=[];return a}};var u,v;k.prototype={enqueue:function(a){var b=this.observer.records_,k=b.length;if(0<b.length){var c=b[k-1];c=c===a?c:!v||c!==v&&c!==u?null:v;if(c){b[k-1]=c;return}}else s.push(this.observer),r||(r=!0,p(y));b[k]=a},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(a){var b=this.options;b.attributes&&a.addEventListener("DOMAttrModified",
this,!0);b.characterData&&a.addEventListener("DOMCharacterDataModified",this,!0);b.childList&&a.addEventListener("DOMNodeInserted",this,!0);(b.childList||b.subtree)&&a.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(a){var b=this.options;b.attributes&&a.removeEventListener("DOMAttrModified",this,!0);b.characterData&&a.removeEventListener("DOMCharacterDataModified",this,!0);b.childList&&a.removeEventListener("DOMNodeInserted",
this,!0);(b.childList||b.subtree)&&a.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(a){if(a!==this.target){this.addListeners_(a);this.transientObservedNodes.push(a);var b=n.get(a);b||n.set(a,b=[]);b.push(this)}},removeTransientObservers:function(){var a=this.transientObservedNodes;this.transientObservedNodes=[];a.forEach(function(a){this.removeListeners_(a);a=n.get(a);for(var b=0;b<a.length;b++)if(a[b]===this){a.splice(b,1);break}},this)},handleEvent:function(a){switch(a.type){case "DOMAttrModified":var k=
a.attrName,n=a.relatedNode.namespaceURI,p=a.target,d=new c("attributes",p);d.attributeName=k;d.attributeNamespace=n;var l=a.attrChange===MutationEvent.ADDITION?null:a.prevValue;e(p,function(a){if(a.attributes&&(!a.attributeFilter||!a.attributeFilter.length||-1!==a.attributeFilter.indexOf(k)||-1!==a.attributeFilter.indexOf(n)))return a.attributeOldValue?b(l):d});break;case "DOMCharacterDataModified":p=a.target;d=c("characterData",p);l=a.prevValue;e(p,function(a){if(a.characterData)return a.characterDataOldValue?
b(l):d});break;case "DOMNodeRemoved":this.addTransientObserver(a.target);case "DOMNodeInserted":var p=a.relatedNode,h=a.target,f;"DOMNodeInserted"===a.type?(a=[h],f=[]):(a=[],f=[h]);var r=h.previousSibling,h=h.nextSibling,d=c("childList",p);d.addedNodes=a;d.removedNodes=f;d.previousSibling=r;d.nextSibling=h;e(p,function(a){if(a.childList)return d})}u=v=void 0}};g.JsMutationObserver=f;!g.MutationObserver&&g.WebKitMutationObserver&&(g.MutationObserver=g.WebKitMutationObserver);g.MutationObserver||(g.MutationObserver=
f)})(this)}catch(e$$15){};(function(){var g;(function(a){a.EVENT_MUT_INSERT=2;a.EVENT_MUT_REMOVE=3;a.EVENT_MUT_ATTR=4;a.EVENT_MUT_ATTR_CURVE=5;a.EVENT_MUT_TEXT=6;a.EVENT_MUT_SKIPIDS=7;a.EVENT_MOUSEMOVE=8;a.EVENT_MOUSEMOVE_CURVE=9;a.EVENT_SCROLL=10;a.EVENT_SCROLL_CURVE=11;a.EVENT_MOUSEDOWN=12;a.EVENT_MOUSEUP=13;a.EVENT_KEYDOWN=14;a.EVENT_KEYUP=15;a.EVENT_CLICK=16;a.EVENT_FOCUS=17;a.EVENT_VALUECHANGE=18;a.EVENT_RESIZE=19;a.EVENT_DOMLOADED=20;a.EVENT_LOAD=21;a.EVENT_PLACEHOLDER_SIZE=22;a.EVENT_UNLOAD=23;a.EVENT_BLUR=24;a.EVENT_SET_FRAME_BASE=
25;a.EVENT_TOUCHSTART=32;a.EVENT_TOUCHEND=33;a.EVENT_TOUCHCANCEL=34;a.EVENT_TOUCHMOVE=35;a.EVENT_TOUCHMOVE_CURVE=36;a.EVENT_NAVIGATE=37;a.EVENT_PLAY=38;a.EVENT_PAUSE=39;a.EVENT_INNERWIDTH=40;a.EVENT_INNERWIDTH_CURVE=41;a.EVENT_LOG=48;a.EVENT_ERROR=49;a.EVENT_DBL_CLICK=50;a.EVENT_FORM_SUBMIT=51;a.EVENT_SYS_SETMETA=8192;a.EVENT_SYS_SETVAR=8193;a.EVENT_SYS_HIGHLIGHT=8194;a.EVENT_COOKED_LOAD="load";a.EVENT_COOKED_UNLOAD="unload";a.EVENT_COOKED_NAVIGATE="navigate";a.EVENT_COOKED_CLICK="click";a.EVENT_COOKED_FOCUS=
"focus";a.EVENT_COOKED_CHANGE="change";a.EVENT_COOKED_MOUSE_THRASH="thrash";a.isUserActionEvent=function(e){switch(e){case a.EVENT_MOUSEDOWN:case a.EVENT_MOUSEMOVE:case a.EVENT_MOUSEMOVE_CURVE:case a.EVENT_MOUSEUP:case a.EVENT_KEYDOWN:case a.EVENT_KEYUP:case a.EVENT_TOUCHSTART:case a.EVENT_TOUCHEND:case a.EVENT_TOUCHMOVE:case a.EVENT_TOUCHMOVE_CURVE:case a.EVENT_TOUCHCANCEL:case a.EVENT_CLICK:case a.EVENT_SCROLL:case a.EVENT_SCROLL_CURVE:case a.EVENT_NAVIGATE:return!0}return!1};a.MAX_LOGS_PER_PAGE=
1024})(g||(g={}));(function(a){function e(a){var k={};if(!a)return k;if(a.classList)for(var c=0;c<a.classList.length;++c)k[a.classList[c]]=!0;else if(a.className)for(a=(null!=a.className.animVal?a.className.animVal:a.className).split(" "),c=0;c<a.length;++c)k[a[c].trim()]=!0;return k}a.NYI_KIND="nyi";a.BLOCKED_KIND="blocked";a.HIDE_KIND="hide";var f=function(){function a(b,c){var p=this;this._parent=b;this._classes={};this._attrs={};for(var d=0,h=0,e=0,f=function(){if(0!=e-h)switch(d){case 0:p._tag=
c.slice(h,e);break;case 1:p._id=c.slice(h+1,e);break;case 2:p._classes[c.slice(h+1,e)]=!0;break;case 3:var a=c.slice(h,e).slice(1).split("="),b=a[0].trim(),a=a[1].trim();if("]"!=a[a.length-1])throw"Unsupported selector";a=a.slice(0,a.length-1);if("'"==a[0]||'"'==a[0]){if(a[a.length-1]!=a[0])throw"Unsupported selector";a=a.slice(1,a.length-1)}p._attrs[b]=a}},e=0;e<c.length;++e)switch(c[e]){case "#":f();d=1;h=e;break;case ".":f();d=2;h=e;break;case "[":f(),d=3,h=e}f()}a.prototype.parent=function(){return this._parent};
a.prototype.serialize=function(){var a="";this._tag&&(a+=this._tag);this._id&&(a+="#"+this._id);for(var b in this._classes)a+="."+b;for(var c in this._attrs)a+="["+c+"="+this._attrs[c]+"]";return a};a.prototype.matches=function(a,b){if(!a||this._tag&&a.tagName.toLowerCase()!=this._tag||this._id&&a.id!=this._id)return!1;for(var c in this._classes)if(!(c in b))return!1;for(var d in this._attrs)if(a.getAttribute(d)!=this._attrs[d])return!1;return this._parent?this._parent.matches(a.parentElement,e(a.parentElement)):
!0};return a}();a.BlockRuleElem=f;var d=function(){function a(b){this.kind=b.Kind;b=b.Selector.split(">");for(var c=null,d=0;d<b.length;)var l=b[d++].trim(),c=new f(c,l);this.rules=c}a.prototype.serialize=function(){for(var a=null,b=this.rules;b;b=b.parent())a=a?b.serialize()+">"+a:b.serialize();return a};return a}();a.BlockRule=d;var c=function(){function a(){this._rules=[];this.rawRules=[]}a.prototype.isBlocked=function(a){for(var b=e(a),c=0;c<this._rules.length;++c)if(this._rules[c].rules.matches(a,
b))return this._rules[c].kind;return null};a.prototype.addRule=function(a){this.rawRules.push(a);this._rules.push(new d(a))};a.prototype.mungeBlockedStyle=function(a,b){var c=a.getBoundingClientRect(),d=Math.floor(c.width),c=Math.floor(c.height);if("object"==a.tagName.toLowerCase())for(var h=a.children,e=0;e<h.length;e++){var f=h[e];if("embed"==f.tagName.toLowerCase()){h=f.getBoundingClientRect();d=Math.max(d,Math.floor(h.width));c=Math.max(c,Math.floor(h.height));break}}h="";null!=b&&(h=b.trim());
0<h.length&&";"!=h.charAt(h.length-1)&&(h+=";");if(0!=d||0!=c)h+="width:"+d+"px;height:"+c+"px;";return h};return a}();a.Blocker=c})(g||(g={}));(function(a){a.Node_ELEMENT_NODE=1;a.Node_ATTRIBUTE_NODE=2;a.Node_TEXT_NODE=3;a.Node_CDATA_SECTION_NODE=4;a.Node_ENTITY_REFERENCE_NODE=5;a.Node_ENTITY_NODE=6;a.Node_PROCESSING_INSTRUCTION_NODE=7;a.Node_COMMENT_NODE=8;a.Node_DOCUMENT_NODE=9;a.Node_DOCUMENT_TYPE_NODE=10;a.Node_DOCUMENT_FRAGMENT_NODE=11;a.Node_NOTATION_NODE=12;a.XHR_UNSENT=0;a.XHR_OPENED=1;a.XHR_HEADERS_RECEIVED=
2;a.XHR_LOADING=3;a.XHR_DONE=4})(g||(g={}));(function(a){function e(a){return"_fsblocked"in a}function f(a,b){a._fsblocked=b}function d(a){return a?a._fs:null}function c(a){return(a=d(a))?a.id:0}function b(a,b){if(a.attributes&&0<a.attributes.length)for(var c=0;c<a.attributes.length;c++){var d=a.attributes[c];b(d.name,d.value)}}a.isBlocked=e;a.blockKind=function(a){return a._fsblocked};a.setBlocked=f;a.mirrorFor=d;a.fsid=c;a.fsidIfNotBlocked=function(a){return e(a)?0:c(a)};var k=function(){function c(a,
b){this._ctx=a;this._blocker=b;this._curId=1}c.prototype.curId=function(){return this._curId};c.prototype.tokenizeNode=function(a,b,c,k){var n=this._curId;try{var e=[],f=this.tokeNode(c,e,k);if(f&&a){var g=d(a),z=d(b);f.parent=g;z==g.child&&(g.child=f);f.next=z;null==z?(f.prev=g.lastChild,g.lastChild=f):f.prev=z.prev;null!=f.prev&&(f.prev.next=f);null!=f.next&&(f.next.prev=f)}return e}catch(A){return this._curId=n,[]}};c.prototype.removeMirror=function(a){a.parent.child==a&&(a.parent.child=a.next);
a.parent.lastChild==a&&(a.parent.lastChild=a.prev);a.prev&&(a.prev.next=a.next);a.next&&(a.next.prev=a.prev);a.id=0;a.child&&this.clearIds(a.child)};c.prototype.clearIds=function(a){a.id=0;a.next&&this.clearIds(a.next);a.child&&this.clearIds(a.child)};c.prototype.tokeNode=function(c,d,k){if("SCRIPT"==c.nodeName||c.nodeType==a.Node_COMMENT_NODE)return null;var n={id:this._curId++,node:c};c._fs=n;var e=c.nodeName;"http://www.w3.org/2000/svg"==c.namespaceURI&&(e="svg:"+e);d.push("<"+e);try{if(this.processBlockedElem(c,
d))return n;k&&k(c);b(c,function(a,b){d.push(":"+a);d.push(b)});if(c.firstChild){d.push("[");for(var e=null,f=c.firstChild;f;f=f.nextSibling){var g=this.tokeNode(f,d,k);g&&(g.parent=n,e?(e.next=g,g.prev=e):n.child=g,e=n.lastChild=g)}d.push("]")}c.nodeType==a.Node_TEXT_NODE&&d.push(c.textContent)}catch(v){}return n};c.prototype.processBlockedElem=function(c,d){var k=this;if(c.nodeType==a.Node_ELEMENT_NODE&&this._blocker){var n=this._blocker.isBlocked(c);if(n){f(c,n);var e,g=!1;b(c,function(a,b){if("class"==
a)b+=" _fs_block_"+n,e=!0;else if("style"==a)b=k._blocker.mungeBlockedStyle(c,b),g=!0;else if("value"==a||"checked"==a||"src"==a)return;d.push(":"+a);d.push(b)});e||(d.push(":class"),d.push("_fs_block_"+n));g||(d.push(":style"),d.push(this._blocker.mungeBlockedStyle(c,"")));return!0}}return!1};return c}();a.NodeEncoder=k})(g||(g={}));(function(a){function e(a,c){var d=Object.getOwnPropertyDescriptor(a.prototype,c);Object.defineProperty(a.prototype,c,{set:function(a){var c=this;setTimeout(function(){b(c)},
0);return d.set.call(this,a)},get:function(){return d.get.call(this)}})}function f(a){switch(a.type){case "checkbox":case "radio":return""+a.checked;default:return a.value}}var d=function(){function d(c,k){var e=this;this._onchange=c;this._checkElem=k;this._fallback=!1;this._elems={};this._values={};b=function(b){var c=a.fsid(b);if(c&&(b=e._elems[c])){var d=f(b);d!=e._values[c]&&(e._onchange(b),e._values[c]=d)}}}d.prototype.hookEvents=function(){var a;(a=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,
"value"))&&a.set?(c||(e(HTMLInputElement,"value"),e(HTMLInputElement,"checked"),e(HTMLSelectElement,"value"),e(HTMLTextAreaElement,"value"),c=!0),a=!0):a=!1;a||(this._fallback=!0)};d.prototype.addInput=function(b){var c=a.fsid(b);this._elems[c]=b;this._values[c]=f(b);this._values[c]&&this._onchange(b)};d.prototype.invokeGlobalOnChange=function(a){b(a)};d.prototype.tick=function(){if(this._fallback)for(var a in this._elems)if(this._checkElem(this._elems[a])){var b=this._elems[a],c=f(b);c!=this._values[a]&&
(this._onchange(b),this._values[a]=c)}else delete this._elems[a],delete this._values[a]};d.prototype._usingFallback=function(){return this._fallback};d.prototype._trackingElem=function(a){return!!this._elems[a]};return d}();a.InputWatcher=d;var c=!1,b;a.valueOfInputishElem=f})(g||(g={}));(function(a){var e=function(){function a(){this.dict={idx:-1,map:{}};this.startIdx=0}a.prototype.encode=function(a){function c(){k?1<f.length?n.push([k.idx,f.length]):n.push(k.idx):n.push(f[0])}if(0==a.length)return[];
var b,k=null,n=[],e,f=[a[0]];for(b=1;b<a.length;b++)if(e=a[b],k&&k.map.hasOwnProperty(e))f.push(e),k=k.map[e];else{c();var h=this.startIdx+b-f.length;null==k&&(k={idx:h,map:{}},this.dict.map[f[f.length-1]]=k);k.map[e]={idx:h,map:{}};f=[e];k=this.dict.map.hasOwnProperty(e)?this.dict.map[e]:null}c();this.startIdx+=a.length;return n};return a}();a.LZJGWEncoder=e;e=function(){function a(){this._seq=[]}a.prototype.sequence=function(){return this._seq};a.prototype.decode=function(a){for(var c=this._seq.length,
b=0;b<a.length;++b){var k=a[b];switch(typeof k){case "string":this._seq.push(k);break;case "number":this._seq.push(this._seq[k]);break;case "object":for(var e=0;e<k[1];e++)this._seq.push(this._seq[k[0]+e])}}return c};return a}();a.LZJGWDecoder=e})(g||(g={}));(function(a){a.MUTATION_PROCESSING_INTERVAL=250;a.CURVE_SAMPLING_INTERVAL=142;a.UPLOAD_INTERVAL=5E3;a.USER_INACTIVITY_TIMEOUT=1E4;var e=function(){function a(c){this._interval=c;this._handle=-1}a.prototype.oneShot=function(a){setTimeout(a,this._interval)};
a.prototype.start=function(a){-1==this._handle&&(this._handle=setInterval(a,this._interval))};a.prototype.stop=function(){-1!=this._handle&&(clearInterval(this._handle),this._handle=-1)};return a}(),f=function(){function d(c,b,d,n,f,l,h,g){void 0===f&&(f=function(){});void 0===l&&(l=new e(a.CURVE_SAMPLING_INTERVAL));void 0===h&&(h=new e(a.MUTATION_PROCESSING_INTERVAL));void 0===g&&(g=new e(a.UPLOAD_INTERVAL));this._ctx=c;this._recUrlPrefix=b;this._processor=d;this._mutProvider=n;this._beforeProcessEvents=
f;this._sampleCurvesTicker=l;this._processMutationsTicker=h;this._uploadTicker=g;this._eventQueue=[];this._outgoingEventQueue=[];this._bundleQueue=[];this._recordingDisabled=!1;this._bundleSeq=1;this._lastWhenTime=this._lastPostTime=0;this._lastWhen=-1;this._lastUserAction=0;this._gotUnload=!1;this._lastBundleTime=c.wallTime()}d.prototype.rawQueue=function(){return this._eventQueue};d.prototype.startPipeline=function(){var a=this;this._recordingDisabled||this._pipelineStarted||(this._lastUserAction=
this._ctx.now(),this.processEvents(),this._processMutationsTicker.start(function(){a.processEvents()}),this._sampleCurvesTicker.start(function(){a.processEvents(!0)}),this._ctx.amInsideIFrame()||(this.enqueueAndSendBundle(),this._uploadTicker.start(function(){a.enqueueAndSendBundle()})),this._pipelineStarted=!0)};d.prototype.enqueue=function(a,b){this.enqueueAt(this._ctx.now(),a,b)};d.prototype.enqueueAt=function(c,b,d){this._recordingDisabled||(c<=this._lastWhen&&(c=this._lastWhen+1),this._lastWhen=
c,this._eventQueue.push({When:c,Kind:b,Args:d}),a.isUserActionEvent(b)&&(this._lastUserAction=c))};d.prototype.disableRecording=function(){this._recordingDisabled=!0;this.stopPipeline()};d.prototype.addUnload=function(){this._gotUnload||(this._gotUnload=!0,this.enqueue(a.EVENT_UNLOAD,[]),this.swanSong())};d.prototype.shutdown=function(){this._flush();this.addUnload();this._flush();this.disableRecording()};d.prototype._flush=function(){this.processEvents();this.maybeSendNextBundle()};d.prototype.prequeue=
function(a,b){this._recordingDisabled||this._eventQueue.unshift({When:0,Kind:a,Args:b})};d.prototype.appendToOutgoingQueue=function(a){this._outgoingEventQueue=this._outgoingEventQueue.concat(a)};d.prototype.appendToQueue=function(a){this._eventQueue=this._eventQueue.concat(a)};d.prototype.lastSentEventTime=function(){return this._lastWhenTime};d.prototype.swanSong=function(){if(!this._recordingDisabled&&!this._ctx.amInsideIFrame()&&(this.processEvents(),0<this._outgoingEventQueue.length&&this.enqueueNextBundle(),
0<this._bundleQueue.length||this._pendingBundle)){var c=this._bundleQueue.concat();this._pendingBundle&&c.unshift(this._pendingBundle);a.log("Saving "+c.length+" bundles in swan-song.");c={UserId:this._ctx.userId(),SessionId:this._ctx.sessionId(),PageId:this._ctx.pageId(),Bundles:c,PageStartTime:this._ctx.startTime(),LastBundleTime:this._lastBundleTime};try{localStorage.swanSong=a.stringify(c)}catch(b){}}};d.prototype.recoverSwanSong=function(){if(!this._ctx.amInsideIFrame())try{if("swanSong"in localStorage){var c=
localStorage.swanSong;delete localStorage.swanSong;var b=a.parseJson(c);if(b.Bundles)if(b.Bundles&&b.UserId&&b.SessionId&&b.PageId)for(c=0;c<b.Bundles.length;++c){var d=null;0==c&&(d=this._ctx.wallTime()-b.LastBundleTime);this.sendSwanSongBundle(b.UserId,b.SessionId,b.PageId,b.PageStartTime,b.Bundles[c],d)}else a.log("Malformed swan song found. Ignoring it.");else b.Bundle&&b.UserId&&b.SessionId&&b.PageId?this.sendSwanSongBundle(b.UserId,b.SessionId,b.PageId,b.PageStartTime||0,b.Bundle,b.LastBundleTime?
this._ctx.wallTime()-b.LastBundleTime:null):a.log("Malformed swan song found. Ignoring it.")}}catch(e){a.log("Error recovering swan-song: "+e)}};d.prototype.sendSwanSongBundle=function(c,b,d,e,f,g){c=this.bundleUrl(this._ctx.orgId(),c,b,d,f,e,g);this._ctx.post(c,f,function(b){a.log("Sent "+f.Evts.length+" trailing events from last session as Seq "+f.Seq)},function(){a.log("Failed to send events from last session")})};d.prototype.rebaseIframe=function(c,b){var d=this._ctx.baseUri();0<this._eventQueue.length?
this._eventQueue.unshift({When:this._eventQueue[0].When,Kind:a.EVENT_SET_FRAME_BASE,Args:[d,b]}):this.enqueue(a.EVENT_SET_FRAME_BASE,[d,b]);for(var d=0,e=this._eventQueue.length;d<e;d++){var f=this._eventQueue[d],g=f.When+this._ctx.startTime()-c;0>g&&(g=0);f.When=g}};d.prototype.processEvents=function(c){this._beforeProcessEvents();if((this._eventQueue.length||this._mutProvider.hasMutations())&&!(this._ctx.now()-this._lastUserAction>a.USER_INACTIVITY_TIMEOUT)&&null!=this._ctx.frameId()){var b=this._eventQueue;
this._eventQueue=[];b=this._processor.processQueue(b);c||(b=b.concat(this._mutProvider.processMutations()));this.ensureFrameIds(b);this._ctx.amInsideIFrame()?parent.postMessage(a.FS_IFRAME_EVENTS+a.FS_DELIMITER+a.stringify(b),"*"):void 0!==this._ctx.pageId()&&(this._outgoingEventQueue=this._outgoingEventQueue.concat(b))}};d.prototype.ensureFrameIds=function(a){var b=this._ctx.frameId();if(b)for(var d=this._ctx.parentIds(),e=d&&0<d.length,f=0;f<a.length;++f){var g=a[f];g.FId||(g.FId=b);e&&!g.PIds&&
(g.PIds=d)}};d.prototype.enqueueAndSendBundle=function(){this._pendingBundle?this._pendingBundleFailed&&this._sendPendingBundle():0==this._outgoingEventQueue.length?this.maybeSendNextBundle():this.enqueueNextBundle()};d.prototype.enqueueNextBundle=function(){var a={When:this._outgoingEventQueue[0].When,Seq:this._bundleSeq++,Evts:this._outgoingEventQueue};this._outgoingEventQueue=[];this._bundleQueue.push(a);this.maybeSendNextBundle()};d.prototype.maybeSendNextBundle=function(){this._ctx.pageId()&&
(!this._pendingBundle&&0!=this._bundleQueue.length)&&(this._pendingBundle=this._bundleQueue.shift(),this._sendPendingBundle())};d.prototype.bundleUrl=function(a,b,d,e,f,g,h){a=this._recUrlPrefix+"/bundle?OrgId="+a+"&UserId="+b+"&SessionId="+d+"&PageId="+e+"&Seq="+f.Seq;g&&(a+="&PageStartTime="+g);h&&(a+="&DeltaT="+h);return a};d.prototype._sendPendingBundle=function(){var c=this,b=this._pendingBundle;this._pendingBundleFailed=!1;var d=this._ctx.wallTime(),e=this.bundleUrl(this._ctx.orgId(),this._ctx.userId(),
this._ctx.sessionId(),this._ctx.pageId(),b);this._lastPostTime=this._lastBundleTime=d;this._lastWhenTime=b.Evts[b.Evts.length-1].When;this._ctx.post(e,b,function(d){a.log("Sent bundle "+b.Seq+" with "+b.Evts.length+" events");c._pendingBundle=null;c._ctx.wallTime()-c._lastPostTime>a.UPLOAD_INTERVAL&&c.maybeSendNextBundle()},function(b){a.log("Failed to send events.");c._pendingBundleFailed=!0;404==b?c._uploadTicker.stop():202==b&&c._uploadTicker.stop()})};d.prototype.stopPipeline=function(){this._pipelineStarted&&
(this._sampleCurvesTicker.stop(),this._processMutationsTicker.stop(),this._uploadTicker.stop())};return d}();a.EventQueue=f})(g||(g={}));(function(a){var e=function(){function e(d,c,b){void 0===b&&(b=function(a,b){});this._ctx=d;this._blocker=c;this._visitor=b;this._sentDomSnapshot=!1;this._records=[];this._lz=new a.LZJGWEncoder;this._encoder=new a.NodeEncoder(d,c)}e.prototype.hasMutations=function(){return!this._sentDomSnapshot||0<this._records.length};e.prototype.hookMutations=function(a){var c=
this;void 0===a&&(a=document.documentElement);this._root=a;this._sentDomSnapshot=!1;(new window.MutationObserver(function(a){c._records=c._records.concat(a)})).observe(a,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0})};e.prototype.processMutations=function(){var d=this._ctx.now(),c=[];this._sentDomSnapshot||(this.genInsert(d,c,null,this._root,null),this._sentDomSnapshot=!0);if(0==this._records.length)return c;var b={},k={};this.processRecords(d,
c,k,b);for(var e in k){var f=e.split(":");c.push({Kind:a.EVENT_MUT_ATTR,When:d,Args:[parseInt(f[0]),f[1],k[e]]})}for(e in b)c.push({Kind:a.EVENT_MUT_TEXT,When:d,Args:[parseInt(e),b[e]]});this._records=[];return c};e.prototype.processRecords=function(d,c,b,e){for(var f={},g={},l=0;l<this._records.length;++l)try{var h=this._records[l],r=a.fsid(h.target);if(r)switch(f[r]=h.target,h.type){case "childList":if(0<h.removedNodes.length)for(var s=0;s<h.removedNodes.length;++s){var q=a.mirrorFor(h.removedNodes[s]);
q&&q.id&&q.parent==a.mirrorFor(h.target)&&q.next==a.mirrorFor(h.nextSibling)&&this.genRemove(d,c,q)}r&&(g[r]=h.target);break;case "characterData":var u=h.target.textContent;h.oldValue!=u&&(a.isBlocked(h.target)||(e[r]=u));break;case "attributes":var v=h.attributeName;h.target.hasAttribute(v)?(u=h.target.getAttribute(v),h.oldValue!=u&&(u=this.rewriteAttr(h.target,v,u),null!==u&&(b[r+":"+v]=u))):b[r+":"+v]=null}}catch(z){}for(var A in g)b=g[A],(e=a.mirrorFor(b))&&e.id&&this.diff(d,c,b,e.child,b.firstChild);
for(A in f)b=f[A],this.maybeAddPlaceholderResize(d,c,b)};e.prototype.diff=function(d,c,b,e,f){for(;e&&f;){var g=a.mirrorFor(f);a.fsid(f)?e.id==g.id?(e=e.next,f=f.nextSibling):(this.genRemove(d,c,e),e=e.next):(this.genInsert(d,c,b,f,e.node),f=f.nextSibling)}for(;e;e=e.next)this.genRemove(d,c,e);for(;f;f=f.nextSibling)this.genInsert(d,c,b,f,null)};e.prototype.maybeAddPlaceholderResize=function(d,c,b){try{for(;b&&!a.fsid(b);)b=b.parentNode;if(b&&a.isBlocked(b)){var e=b.getBoundingClientRect(),f=Math.floor(e.width),
g=Math.floor(e.height);c.push({When:d,Kind:a.EVENT_PLACEHOLDER_SIZE,Args:[a.fsid(b),f,g]})}}catch(l){}};e.prototype.genInsert=function(d,c,b,e,f){var g=this;if(b&&a.isBlocked(b))return null;e=this._encoder.tokenizeNode(b,f,e,function(a){g._visitor(d,a)});0<e.length&&c.push({When:d,Kind:a.EVENT_MUT_INSERT,Args:[a.fsid(b)||-1,a.fsid(f)||-1,this._lz.encode(e)]})};e.prototype.genRemove=function(d,c,b){var e=b.id;this._encoder.removeMirror(b);if(0<c.length&&(b=c[c.length-1],b.Kind==a.EVENT_MUT_REMOVE)){b.Args.push(e);
return}c.push({When:d,Kind:a.EVENT_MUT_REMOVE,Args:[e]})};e.prototype.rewriteAttr=function(d,c,b){switch(c){case "style":a.isBlocked(d)&&(b=this._blocker.mungeBlockedStyle(d,b));break;case "class":a.isBlocked(d)&&0>b.indexOf("_fs_block_")&&(d=a.blockKind(d),b+=" _fs_block_"+d);break;case "value":a.isBlocked(d)&&(b=null)}return b};return e}();a.MutationHandler=e})(g||(g={}));(function(a){var e=function(){function a(c,b,d){this._ctx=c;this._q=b;this._valueIndices=d;this._evts=[]}a.prototype.add=function(a){0==
this._evts.length&&this._q.push(a);this._evts.push(a)};a.prototype.finish=function(a,b){var d=this._evts.length;if(1>=d)return!1;for(var e=this._evts[0].When,f=this._evts[d-1].When,g=0;g<this._valueIndices.length;++g){var h=this._valueIndices[g],r=this._evts[0].Args[h],s=(this._evts[1].When-e)/(f-e),q=(this._evts[1].Args[h]-r)/s,u=this._evts[d-1].Args[h],s=(f-this._evts[d-2].When)/(f-e);b.push(r,u,q,(u-this._evts[d-2].Args[h])/s)}this._evts[0].Kind=a;this._evts[0].Args=b;return!0};a.prototype.evts=
function(){return this._evts};return a}(),f=function(){function d(a,b){this._ctx=a;this._blocker=b;this._gotInitialScroll=!1}d.prototype.processQueue=function(c){if(0==c.length)return c;this.maybeAddInitialScroll();for(var b=this._ctx.now(),d=[],f=new e(this._ctx,d,[0,1]),g={},l={},h,r=0;r<c.length;++r){var s=c[r];switch(s.Kind){case a.EVENT_MOUSEMOVE:f.add(s);break;case a.EVENT_TOUCHMOVE:var q=s.Args[0];q in g||(g[q]=new e(this._ctx,d,[1,2]));g[q].add(s);break;case a.EVENT_SCROLL:q=s.Args[0];q in
l||(l[q]=new e(this._ctx,d,[1,2]));l[q].add(s);break;case a.EVENT_INNERWIDTH:h||(h=new e(this._ctx,d,[0]));h.add(s);break;default:d.push(s)}}f.finish(a.EVENT_MOUSEMOVE_CURVE,[b])&&(c=f.evts(),f=c[c.length-1].Args,2<f.length&&f[2]&&c[0].Args.push(f[2]));for(q in l)c=parseInt(q),l[c].finish(a.EVENT_SCROLL_CURVE,[b,c]);for(q in g)c=parseInt(q),g[c].finish(a.EVENT_TOUCHMOVE_CURVE,[b,c]);h&&h.finish(a.EVENT_INNERWIDTH_CURVE,[b]);return d};d.prototype.maybeAddInitialScroll=function(){!this._gotInitialScroll&&
(document.body&&a.fsid(document.body))&&(this._ctx.addWindowScroll(),this._gotInitialScroll=!0)};return d}();a.EventProcessor=f})(g||(g={}));(function(a){var e=function(){function e(a){this._queue=a;this._overflow=this._enabled=!1;this._total=0}e.prototype.enable=function(){var a=this;a._enabled||(a._enabled=!0,window.console?(console.log&&console.log.apply&&(a._oldLog=console.log,console.log=function(){a.addLog("log",arguments);return a._oldLog.apply(this,arguments)}),console.info&&console.info.apply&&
(a._oldInfo=console.info,console.info=function(){a.addLog("info",arguments);return a._oldInfo.apply(this,arguments)}),console.warn&&console.warn.apply&&(a._oldWarn=console.warn,console.warn=function(){a.addLog("warn",arguments);return a._oldWarn.apply(this,arguments)}),console.error&&console.error.apply&&(a._oldError=console.error,console.error=function(){a.addLog("error",arguments);return a._oldError.apply(this,arguments)})):a.addLog("log",["NOTE: Log messages cannot be captured on IE9"]),a._oldOnError=
window.onerror,window.onerror=function(c,b,e){a.addError(c,b,e);if(a._oldOnError)return a._oldOnError.apply(this,arguments)})};e.prototype.disable=function(){this._enabled&&(this._enabled=!1,this._oldLog&&(console.log=this._oldLog),this._oldInfo&&(console.info=this._oldInfo),this._oldWarn&&(console.warn=this._oldWarn),this._oldError&&(console.error=this._oldError),window.onerror=this._oldOnError)};e.prototype.addLog=function(d,c){if(this.checkOverflow()){for(var b=[d],e=0;e<c.length;++e){try{var f=
a.stringify(c[e])}catch(g){f=a.stringify(c[e].toString())}b.push(f)}this._queue.enqueue(a.EVENT_LOG,b)}};e.prototype.addError=function(d,c,b){this.checkOverflow()&&this._queue.enqueue(a.EVENT_ERROR,[d,c,b])};e.prototype.checkOverflow=function(){if(this._overflow)return!1;if(this._total==a.MAX_LOGS_PER_PAGE)return this._queue.enqueue(a.EVENT_LOG,["warn",e.OVERFLOW_MSG]),this._overflow=!0,!1;this._total++;return!0};e.OVERFLOW_MSG='"[received more than '+a.MAX_LOGS_PER_PAGE+' messages; no longer recording console]"';
return e}();a.ConsoleHook=e})(g||(g={}));(function(a){var e="fs_uid",f=function(){function d(a,b){this._host=a;this._orgId=b;this._appKey=this._sessionId=this._userId=this._domain="";this._poisoned=!1;this._cookies={};for(var d=document.cookie.split(";"),f=0;f<d.length;f++){var g=d[f].replace(/^\s+|\s+$/g,"").split("=");this._cookies[g[0]]=g[1]}if(d=this._cookies[e])d=d.split("`"),3>d.length?this._userId=this._cookies[e]:d[0]==this._host&&d[1]==this._orgId&&(this._userId=d[2],5<=d.length&&(this._appKey=
decodeURIComponent(d[3]),this._poisoned="true"==d[4]));d=this._userId.indexOf(":");-1!=d&&(this._sessionId=this._userId.slice(d+1),this._userId=this._userId.slice(0,d))}d.prototype.host=function(){return this._host};d.prototype.orgId=function(){return this._orgId};d.prototype.userId=function(){return this._userId};d.prototype.sessionId=function(){return this._sessionId};d.prototype.appKey=function(){return this._appKey};d.prototype.poisoned=function(){return this._poisoned};d.prototype.cookies=function(){return this._cookies};
d.prototype.setCookie=function(a,b){var d=a+"="+b,d=this._domain?d+("; domain=."+encodeURIComponent(this._domain)):d+"; domain=";document.cookie=d+"; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/"};d.prototype.setIds=function(a,b,d){if("localhost"==a||"127.0.0.1"==a)a="";this._domain=a;this._userId=b;this._sessionId=d;this.write()};d.prototype.setAppId=function(d){if(!d)return this._poisoned?(a.log("blocking FS.setUserVars API call due to mismatched user ID"),!1):!0;if(this._appKey&&this._appKey!=
d)return a.log("blocking FS.identify API call; existing uid ("+this._appKey+") does not match provided uid ("+d+")"),this._poisoned=!0,this.write(),!1;this._appKey=d;this._poisoned=!1;this.write();return!0};d.prototype.write=function(){var a=this._host+"`"+this._orgId+"`"+this._userId+":"+this._sessionId;this._appKey&&(a+="`"+encodeURIComponent(this._appKey)+"`"+this._poisoned);this.setCookie(e,a)};return d}();a.Identity=f})(g||(g={}));(function(a){var e=function(){function e(a,c){this._queue=a;this._identity=
c;this.AccountSystemVars={acctId:"str",displayName:"str",website:"str"};this.UserSystemVars={uid:"str",displayName:"str",email:"str"};this.VarTypes={str:function(a){return"string"==typeof a},bool:function(a){return"boolean"==typeof a},"int":function(a){return"number"==typeof a&&0==a-Math.floor(a)},real:function(a){return"number"==typeof a},date:function(a){return!isNaN(a.constructor===Date?a:new Date(a))}}}e.prototype.api=function(d,c){switch(d){case "account":if(this._identity.poisoned()){a.log("blocking FS.identifyAccount API call due to mismatched user ID");
break}this.setvar_api("acct",this.AccountSystemVars,c);break;case "user":if(!this._identity.setAppId(c.uid))break;this.setvar_api("user",this.UserSystemVars,c);break;default:a.log('invalid operation "'+d+'"; only "account" and "user" are supported at present')}};e.prototype.processApiQueue=function(a){if(a)for(var c=0;c<a.length;c++)this.api(a[c][0],a[c][1])};e.prototype.setvar_api=function(d,c,b){var e={},f;for(f in b)if(b.hasOwnProperty(f)){var g=b[f];a.log("set-var('"+d+"'): \""+f+'" = '+a.stringify(g));
var l,h;if(f in c)l=f,h=c[f];else{h=f.split("_");if(2!=h.length){a.log('variables must be of the form "name_type", where "type" is one of [str, bool, int, real, date]');this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["badvarname",d+":"+f]);continue}-1!=f.indexOf(" ")?(l=f.replace(/ /g,""),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["badvarname",d+":"+f]),a.log("Warning: variable '"+f+"' has spaces in it, which is disallowed. Converted name to '"+l+"'.")):l=f;h=h[1]}h in this.VarTypes?this.VarTypes[h](g)?
("str"==h&&(g=(g=/\b.*\b/g.exec(g))?g[0]:""),"date"==h&&(g=this.toIsoString(g)),e[l]=g):(a.log("illegal value "+a.stringify(g)+" for type "+h),l=typeof g,"number"===l?l=0==g-Math.floor(g)?"integer":"real":"object"==l&&(null!=g&&g.constructor==Date)&&(l="date"),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["badvartype",d+":"+f,l])):(a.log('invalid type "'+h+'"'),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["badvarname",d+":"+f]))}this._queue.enqueue(a.EVENT_SYS_SETVAR,[d,a.stringify(e)])};e.prototype.toIsoString=
function(a){return(a.constructor===Date?a:new Date(a)).toISOString()};return e}();a.Vars=e})(g||(g={}));(function(a){function e(a){F&&window.console&&console.log(a)}function f(a){B||(B=window.JSON);var b=Array.prototype.toJSON,d=String.prototype.toJSON;b&&delete Array.prototype.toJSON;d&&delete String.prototype.toJSON;a=B.stringify(a);b&&(Array.prototype.toJSON=b);d&&(String.prototype.toJSON=d);return a}function d(a){B||(B=window.JSON);return B.parse(a)}function c(){return(new Date).getTime()}function b(){return window!=
top&&!Y}function g(b,d,c,h){void 0===h&&(h=null);b="//"+t.host()+b;var k=null;null!=d&&(k=f(d),N+=k.length,e("total bytes written: "+N));var l=new XMLHttpRequest;if("withCredentials"in l)l.onreadystatechange=function(){l.readyState==a.XHR_DONE&&(200==l.status?c(l.responseText):h(l.status))},l.open("POST",G+b,!0),l.withCredentials=!0,l.setRequestHeader("Content-Type","text/plain"),l.send(k);else{var m=new XDomainRequest;m.onload=function(){c(m.responseText)};m.onerror=function(){h("Not Found"==m.responseText?
404:500)};m.onprogress=function(){};m.open("POST",b);m.send(k)}}function n(){if("baseURI"in document)return document.baseURI;var a=document.getElementsByTagName("base")[0];return a&&a.href?a.href:location.href}function p(a){(a=a.target.tagName)&&(a=a.toLowerCase());return a}function l(a,b){return a.tagName&&a.tagName.toLowerCase()in b?!0:a.parentNode?l(a.parentNode,b):!1}function h(a,b){if(void 0!==a.changedTouches)for(var d=0;d<a.changedTouches.length;++d){var c=a.changedTouches[d];isNaN(parseInt(c.identifier))&&
(c.identifier=0);m.enqueue(b,[c.identifier,c.clientX,c.clientY])}}function r(){var a=document.activeElement;a&&H.invokeGlobalOnChange(a)}function s(){var b=window.innerWidth;b!=Z&&(m.enqueue(a.EVENT_INNERWIDTH,[b]),Z=b)}function q(a,b){a in O||(O[a]=setTimeout(function(){delete O[a];b()},ma))}function u(){var b=a.fsid(document.body);b&&q(b,function(){var d,c;"pageXOffset"in window?(d=window.pageXOffset,c=window.pageYOffset):(d=document.body.scrollLeft,c=document.body.scrollTop);if(d!=$||c!=aa)m.enqueue(a.EVENT_SCROLL,
[b,d,c]),$=d,aa=c;s()})}function v(b){var d=b.target,c=a.fsid(d);c&&q(c,function(){m.enqueue(a.EVENT_SCROLL,[c,d.scrollLeft,d.scrollTop])})}function z(){ba?m.enqueue(a.EVENT_RESIZE,[document.body.clientWidth,document.body.clientHeight]):m.enqueue(a.EVENT_RESIZE,[document.documentElement.clientWidth,document.documentElement.clientHeight])}function A(){var b=location.href;P!=b&&(P=b,m.enqueue(a.EVENT_NAVIGATE,[location.href,document.title]))}function y(b){var d=a.fsidIfNotBlocked(b);d&&m.enqueue(a.EVENT_VALUECHANGE,
[d,a.valueOfInputishElem(b)])}function V(a){t.setIds(a.CookieDomain,a.UserIntId,a.SessionIntId);Q=a.PageIntId;ca=a.EmbedToken;e("/User,"+t.userId()+"/Session,"+t.sessionId()+"/Page,"+Q)}function L(a){if(I&&a){var b=document.createElement("script");b.text=a;b.async=!0;document.head.appendChild(b)}}function M(){var a=document.doctype;if(!a)return null;var b;b="<!DOCTYPE "+a.name;a.publicId&&(b+=' PUBLIC "'+a.publicId+'"');a.systemId&&(b+=' "'+a.systemId+'"');return b+">"}function ka(){var a=document.documentElement,
b=window._fs_hash,c=window._fs_replay_flags;P=location.href;if(J)a={OrgId:t.orgId(),UserId:t.userId(),Url:location.href,Base:n(),ScreenWidth:window.screen.width,ScreenHeight:window.screen.height,Width:a.clientWidth,Height:a.clientHeight,Referrer:document.referrer,Doctype:M(),Hash:b},c&&(a.ReplayFlags=c),g(R+"/page",a,function(a){try{var b=d(a)}catch(c){X();return}a=b;V(a);S=a.IntegrationScript;L(a.IntegrationScript);if(window._fs_ready)try{window._fs_ready()}catch(f){e("exception in _fs_ready(): "+
f)}for(a=0;a<b.Blocks.length;++a)try{x.addRule(b.Blocks[a])}catch(g){e("Unexpected error parsing block rule. Skipping "+b.Blocks[a])}m.startPipeline()},function(a){X()});else{e("Unable to record playback stream.");var f=document.createElement("script");window.__fs_startResponse=function(a){V(a);S=a.IntegrationScript;L(a.IntegrationScript);document.body.removeChild(f)};f.src="//"+t.host()+R+"/page?OrgId="+t.orgId()+"&UserId="+t.userId()+"&Url="+encodeURIComponent(location.href)+"&Base="+encodeURIComponent(n())+
"&ScreenWidth="+window.screen.width+"&ScreenHeight="+window.screen.height+"&Width="+a.clientWidth+"&Height="+a.clientHeight+"&Referrer="+encodeURIComponent(document.referrer)+"&Doctype="+encodeURIComponent(M())+"&Fallback=true"+(c?"&ReplayFlags="+c:"")+(b?"&Hash="+b:"");document.body.appendChild(f)}}function X(){m.disableRecording();da();e("Disabling FS.");if(window._fs_ready)try{window._fs_ready(!0)}catch(a){e("exception in _fs_ready(): "+a)}}function la(){ea.hookMutations();document.documentElement.addEventListener("scroll",
function(a){v(a)},!0);window.addEventListener("mousemove",function(b){b=a.fsid(b.target)?[b.clientX,b.clientY,a.fsid(b.target)]:[b.clientX,b.clientY];m.enqueue(a.EVENT_MOUSEMOVE,b)},!0);window.addEventListener("mousedown",function(b){m.enqueue(a.EVENT_MOUSEDOWN,[b.clientX,b.clientY]);!l(b.target,{button:!0,a:!0,input:!0})||"input"==p(b)&&"submit"!=b.target.type||m.swanSong()},!0);window.addEventListener("mouseup",function(b){m.enqueue(a.EVENT_MOUSEUP,[b.clientX,b.clientY])},!0);window.addEventListener("keydown",
function(b){var d=document.activeElement;if(!d||a.fsidIfNotBlocked(d))r(),m.enqueue(a.EVENT_KEYDOWN,[b.keyCode]);switch(p(b)){case "button":13!=b.keyCode&&32!=b.keyCode||m.swanSong();break;case "a":13==b.keyCode&&m.swanSong();break;case "input":"submit"==b.target.type&&13==b.keyCode&&m.swanSong()}},!0);window.addEventListener("keyup",function(b){var d=document.activeElement;if(!d||a.fsidIfNotBlocked(d))r(),m.enqueue(a.EVENT_KEYUP,[b.keyCode])},!0);window.addEventListener("scroll",function(a){u()});
window.addEventListener("resize",function(a){z()});window.addEventListener("submit",function(b){(b=a.fsid(b.target))&&m.enqueue(a.EVENT_FORM_SUBMIT,[b])});document.body.addEventListener("click",function(b){(b=a.fsid(b.target))&&m.enqueue(a.EVENT_CLICK,[b])},!0);document.body.addEventListener("dblclick",function(b){(b=a.fsid(b.target))&&m.enqueue(a.EVENT_DBL_CLICK,[b])},!0);document.body.addEventListener("focus",function(b){(b=a.fsid(b.target))&&m.enqueue(a.EVENT_FOCUS,[b])},!0);document.body.addEventListener("blur",
function(b){(b=a.fsid(b.target))&&m.enqueue(a.EVENT_BLUR,[b])},!0);document.body.addEventListener("change",function(a){y(a.target)},!0);window.addEventListener("touchstart",function(b){h(b,a.EVENT_TOUCHSTART);u()},!0);window.addEventListener("touchend",function(b){h(b,a.EVENT_TOUCHEND);u()},!0);window.addEventListener("touchmove",function(b){h(b,a.EVENT_TOUCHMOVE);u()},!0);window.addEventListener("touchcancel",function(b){h(b,a.EVENT_TOUCHCANCEL)},!0);window.addEventListener("play",function(b){var d=
a.EVENT_PLAY;(b=a.fsid(b.target))&&m.enqueue(d,[b])},!0);window.addEventListener("pause",function(b){var d=a.EVENT_PAUSE;(b=a.fsid(b.target))&&m.enqueue(d,[b])},!0);H.hookEvents();if(history.pushState){window.addEventListener("popstate",function(){A()});var b=history.pushState;history.pushState=function(a,d,c){b.call(this,a,d,c);A()};var d=history.replaceState;history.replaceState=function(a,b,c){d.call(this,a,b,c);A()}}}function W(){fa.enable()}function na(){var d=function(){I||(I=!0,m.enqueue(a.EVENT_DOMLOADED,
[]),la(),z(),L(S))},c=!1,e=function(){c||(c=!0,m.enqueue(a.EVENT_LOAD,[]))};switch(document.readyState){case "interactive":document.attachEvent||d();break;case "complete":d(),e()}I||document.addEventListener("DOMContentLoaded",function(a){d()});c||window.addEventListener("load",function(a){d();e()});b()||(window.addEventListener("beforeunload",function(a){m.addUnload()}),window.addEventListener("unload",function(a){m.addUnload()}))}function ga(){return t.userId()?t.userId()+":"+t.sessionId():null}
function oa(){window.addEventListener("message",function(b){if("string"==typeof b.data&&0==b.data.indexOf(a.FS_MESSAGE_PREFIX)){var c=b.data.split(a.FS_DELIMITER);if(c[0]==a.FS_SET_FRAME_ID_CMD)try{var f=parseInt(c[1]),g=d(c[2]),h=parseInt(c[3]);var k=d(c[4]);if(f)if(w)e("frame Id is already set to "+w+". Received second request to set it to "+f+" Iframe:"+location.href);else{e("FrameId received within frame "+location.href+": "+f);w=f;K=g;for(c=0;c<k.length;++c)x.addRule(k[c]);m.rebaseIframe(h,M());
D=h;m.startPipeline();if(0<E.length){for(c=0;c<E.length;c++)E[c]();E=[]}}else e("Outer page gave us a bogus frame Id! Iframe: "+location.href)}catch(l){e("Failed to parse frameId from message"+b.data)}else c[0]==a.FS_DISABLE_RECORDING?(m.disableRecording(),da()):b.source==parent&&e("Invalid _fs postmessage command: "+c[0])}});w||(0==w?e("For some reason the outer window attempted to request a frameId"):(e("Asking for a frame ID from within frame: "+location.href),parent.postMessage(a.FS_REQUEST_FRAME_ID+
a.FS_DELIMITER,"*")))}function da(){for(var b=0;b<C.length;b++){var c=C[b];c.contentWindow&&c.contentWindow.postMessage&&c.contentWindow.postMessage(a.FS_DISABLE_RECORDING,"*")}}function pa(){window.addEventListener("message",function(c){if("string"==typeof c.data&&0==c.data.indexOf(a.FS_MESSAGE_PREFIX)){var f=c.data.split(a.FS_DELIMITER);if(f[0]==a.FS_IFRAME_EVENTS)c=d(f[1]),0<c.length&&(b()?m.appendToQueue(c):m.appendToOutgoingQueue(c));else{var g;a:{g=c.source;for(var h=0;h<C.length;h++)if(C[h].contentWindow==
g){g=a.fsid(C[h]);break a}e("Unable to locate frame for window");g=NaN}f[0]==a.FS_REQUEST_FRAME_ID?c.source&&g?(e("Responding to FID request for frame "+g),ha(c.source,g)):e("No FrameId found. Hoping to send one later."):b()||e("Invalid _fs postmessage command: "+f[0]+" sent from child FrameId: "+g)}}})}function ha(b,c){var d=function(){var d=f(x.rawRules),e=[];0!=w&&(e=K?K.concat(w):[w]);b.postMessage(a.FS_SET_FRAME_ID_CMD+a.FS_DELIMITER+c+a.FS_DELIMITER+f(e)+a.FS_DELIMITER+D+a.FS_DELIMITER+d,"*")};
null==w?E.push(d):d()}function ia(a){e("Injecting into Frame ["+a.src+"]");try{if(a.src&&("about:blank"!=a.src&&0>a.src.indexOf("javascript:"))&&a.src!=a.contentWindow.location.href)e("Frame not yet loaded: "+a.src);else if(a.contentWindow.FS)e("FS already defined in Frame contentWindow: "+a.src+". Ignoring.");else{var b=a.contentDocument,c="var _fs_org='"+t.orgId()+"', _fs_host='"+t.host()+"', _fs_run_in_iframe=true, _fs_debug="+F+"; (function(w,a,t){a=w.createElement('script');a.async=1;a.src='"+
G+"//'+_fs_host+'/s/fs.js';w.head.appendChild(a)})(document);",d=b.createElement("script");d.textContent=c;b.head.appendChild(d)}}catch(f){e("iFrame no injecty. Probably not same origin.")}}function qa(a,b){C.push(b);ra(b)?(e("Attempting to setup Frame ["+b.src+"]"),ia(b),b.addEventListener("load",function(a){e("onload for frame ["+b.src+"]");ia(b)})):(e("Frame Doesn't need injecting. Probably cross domain ["+b.src+"]"),b.contentWindow.postMessage&&(e("Eagerly sending FrameId "+a+" to Frame ["+b.src+
"]"),ha(b.contentWindow,a)))}function ra(a){var b=a.src;return!a.hasAttribute("src")||"about:blank"==b||0==b.indexOf("javascript:")||0==b.indexOf(sa)}var ma=a.MUTATION_PROCESSING_INTERVAL/5,F=!1,N=0,Q,w,K,sa=window.location.protocol+"//"+window.location.host,Y,J,D=c(),P,I=!1,S=null,ja,$=-1,aa=-1,Z=0,O={},ca,B,ba=!1,G="https:",T={startTime:function(){return D},now:function(){return c()-D},wallTime:c,orgId:function(){return t.orgId()},userId:function(){return t.userId()},sessionId:function(){return t.sessionId()},
pageId:function(){return Q},baseUri:n,amInsideIFrame:b,frameId:function(){return w},parentIds:function(){return K},post:g,addWindowScroll:u},R=0>c()%1E3?"/recvm":"/rec",x=new a.Blocker,H=new a.InputWatcher(function(a){y(a)},function(b){return!!a.fsid(b)}),ea=new a.MutationHandler(T,x,function(b,c){switch(c.nodeName){case "INPUT":case "TEXTAREA":case "SELECT":H.addInput(c);break;case "FRAME":case "IFRAME":var d=a.fsid(c);if(!d){e("fsid missing or invalid for iFrame."+c.src);break}ja||(pa(),ja=!0);
qa(d,c);break;case "VIDEO":case "AUDIO":c.paused||(d=a.fsid(c),m.enqueue(a.EVENT_PLAY,[d]))}}),ta=new a.EventProcessor(T,x),m=new a.EventQueue(T,R,ta,ea,function(){H.tick();s()}),fa=new a.ConsoleHook(m),t,U;window._fs_shutdown=function(a){m.shutdown();a&&(a=document.getElementById(a))&&a.setAttribute("_fs_embed_token",ca)};a.log=e;a.stringify=f;a.parseJson=d;a.enableConsole=W;a.disableConsole=function(){fa.disable()};a._init=function(){if("_fs_host"in window||"_fs_ext_host"in window)if("_fs_org"in
window||"_fs_ext_org"in window){"_fs_ext_debug"in window?F=!!window._fs_ext_debug:"_fs_debug"in window&&(F=!!window._fs_debug);var c=window._fs_ext_host||window._fs_host,d=window._fs_ext_org||window._fs_org;e("host: "+c);e("orgid: "+d);t=new a.Identity(c,d);U=new a.Vars(m,t);0==c.indexOf("localhost")&&(G="");ba="BackCompat"==document.compatMode;Y=!!window._fs_is_outer_script;w=b()?null:0;J=!!window.MutationEvent;b()?window._fs_run_in_iframe?parent.postMessage?oa():(J=!1,e("postMessage not supported")):
e("Fullstory recording for this page is NOT allowed within an iFrame."):(x.addRule({Selector:"object",Kind:a.NYI_KIND}),x.addRule({Selector:"embed",Kind:a.NYI_KIND}),x.addRule({Selector:"canvas",Kind:a.NYI_KIND}),x.addRule({Selector:"noscript",Kind:a.BLOCKED_KIND}),x.addRule({Selector:".fs-hide",Kind:a.HIDE_KIND}),U.processApiQueue(window.FS.q),delete window.FS.q,ka())}else e("Missing global _fs_org. Recording disabled.");else e("Missing global _fs_host. Recording disabled.")};a._record=function(){J&&
(m.recoverSwanSong(),D=c(),na(),W())};a._api=function(a,b){U.api(a,b)};a.setUid=function(b,c,d){b&&"string"==typeof b?c&&"string"!=typeof c?e("setUid(): second argument (display name) must be a string"):(c||(c=b),d&&"object"!=typeof d?e('setUid(): third argument (metadata) must be of the form {name0: "value0", name1: "value1", ...}'):(d=d?f(d):"",e("setting uid: "+b+", meta: "+d),m.enqueue(a.EVENT_SYS_SETMETA,[b,c,d]))):e("setUid(): first argument (user id) is required and must be a string")};a.getCurrentSessionURL=
function(){var a=ga();return a?G+"//"+t.host()+"/ui/"+t.orgId()+"/session/"+a:null};a.getCurrentSession=ga;a._cookies=function(){return t.cookies()};a._setCookie=function(a,b){return t.setCookie(a,b)};a.FS_MESSAGE_PREFIX="_fs";a.FS_DELIMITER="{\uffff}";a.FS_REQUEST_FRAME_ID=a.FS_MESSAGE_PREFIX+"RequestFrameId";a.FS_SET_FRAME_ID_CMD=a.FS_MESSAGE_PREFIX+"SetFrameId";a.FS_IFRAME_EVENTS=a.FS_MESSAGE_PREFIX+"EvtBundle";a.FS_DISABLE_RECORDING=a.FS_MESSAGE_PREFIX+"DisableRecording";var C=[],E=[]})(g||(g=
{}));try{"FS"in window||(window.FS={}),"_loaded"in window.FS||(window.FS._loaded=!0,window.FS.setUid=g.setUid,window.FS.getCurrentSessionURL=g.getCurrentSessionURL,window.FS.getCurrentSession=g.getCurrentSession,window.FS.enableConsole=g.enableConsole,window.FS.disableConsole=g.disableConsole,window.FS.log=g.log,window.FS._api=g._api,window.FS._cookies=g._cookies,window.FS._setCookie=g._setCookie,g._init(),g._record())}catch(y){window.console&&console.log&&console.log("Failed to initialize FullStory.")}})();
//# sourceMappingURL=/s/fs.map